{
  "name": "Telegram Termin-Agent (Open Source)",
  "nodes": [
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $('Telegram Trigger').isExecuted ? $node[\"Telegram Trigger\"].json.message.text : ($('Transcribe a recording').isExecuted ? $node[\"Transcribe a recording\"].json.text : \"Guten Morgen! Bitte gib mir eine kurze Übersicht über alle meine Termine für den heutigen Tag.\") }}",
        "options": {
          "systemMessage": "=### ROLLE UND AUFGABE\nDu bist ein hochpräziser Kalender-Assistent. Deine Hauptaufgabe ist das Verwalten von Google Calendar Terminen.\n\n### DATUM-REFERENZ\n- Heute ist: {{ $now.setZone('Europe/Berlin').toFormat('EEEE, dd.MM.yyyy') }}\n- Aktuelle Uhrzeit: {{ $now.setZone('Europe/Berlin').toFormat('HH:mm') }} Uhr\n\n... (Restliche Logik bleibt erhalten) ..."
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3,
      "position": [32, -160],
      "id": "ai-agent-id",
      "name": "AI Agent"
    },
    {
      "parameters": {
        "sessionIdType": "customKey",
        "sessionKey": "=YOUR_SESSION_ID"
      },
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "typeVersion": 1.3,
      "position": [-80, 64],
      "id": "memory-id",
      "name": "Simple Memory"
    },
    {
      "parameters": {
        "operation": "getAll",
        "calendar": {
          "__rl": true,
          "value": "YOUR_EMAIL@gmail.com",
          "mode": "list"
        },
        "timeMin": "={{ $fromAI('After', ``, 'string') }}",
        "timeMax": "={{ $fromAI('Before', ``, 'string') }}"
      },
      "type": "n8n-nodes-base.googleCalendarTool",
      "typeVersion": 1.3,
      "position": [32, 160],
      "id": "gcal-get-id",
      "name": "Get many events in Google Calendar"
    },
    {
      "parameters": {
        "chatId": "YOUR_TELEGRAM_CHAT_ID",
        "text": "={{ $json.output.split('}').pop().trim() }}"
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [592, -160],
      "id": "telegram-send-id",
      "name": "Send a text message"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-4o-mini"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.3,
      "position": [-208, -16],
      "id": "openai-model-id",
      "name": "OpenAI Chat Model"
    },
    {
      "parameters": {
        "conditions": {
          "conditions": [
            {
              "leftValue": "={{ $json.message.from.id }}",
              "rightValue": "YOUR_TELEGRAM_CHAT_ID",
              "operator": {
                "type": "number",
                "operation": "equals"
              }
            }
          ]
        }
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [-768, -288],
      "id": "id-check-id",
      "name": "Richtige ID?"
    },
    {
      "parameters": {
        "rule": {
          "interval": [{ "triggerAtHour": 8 }]
        }
      },
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.3,
      "position": [-816, 32],
      "id": "schedule-id",
      "name": "Schedule Trigger"
    }
  ],
  "connections": {
    "Simple Memory": { "ai_memory": [[{ "node": "AI Agent", "type": "ai_memory", "index": 0 }]] },
    "Get many events in Google Calendar": { "ai_tool": [[{ "node": "AI Agent", "type": "ai_tool", "index": 0 }]] },
    "AI Agent": { "main": [[{ "node": "Send a text message", "type": "main", "index": 0 }]] },
    "OpenAI Chat Model": { "ai_languageModel": [[{ "node": "AI Agent", "type": "ai_languageModel", "index": 0 }]] },
    "Schedule Trigger": { "main": [[{ "node": "AI Agent", "type": "main", "index": 0 }]] },
    "Telegram Trigger": { "main": [[{ "node": "Richtige ID?", "type": "main", "index": 0 }]] },
    "Richtige ID?": { "main": [[{ "node": "Ist es eine Voicemail?", "type": "main", "index": 0 }], [{ "node": "Send a text message1", "type": "main", "index": 0 }]] }
  }
}